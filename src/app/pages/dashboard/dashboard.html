<section class="min-h-screen home-page p-6">
    <div class="mx-auto max-w-7xl space-y-6">
        <app-dashboard-header [totalEnquiries]="totalEnquiries"></app-dashboard-header>

        <div class="grid gap-4 sm:grid-cols-2 xl:grid-cols-4">
            <app-stats-card label="All Enquiries" [value]="totalEnquiries" colorClass="text-white"></app-stats-card>
            <app-stats-card label="Converted" [value]="convertedCount" colorClass="text-emerald-300"></app-stats-card>
            <app-stats-card label="Pending Follow-Up" [value]="pendingFollowUpCount"
                colorClass="text-amber-300"></app-stats-card>
            <app-stats-card label="Today Enquiries" [value]="todayEnquiriesCount"
                colorClass="text-cyan-300"></app-stats-card>
        </div>

        <div class="grid gap-6 lg:grid-cols-2">
            <div class="rounded-xl border border-slate-700 bg-slate-850/90 p-4 shadow-lg">
                <h2 class="mb-4 text-lg font-semibold text-white">Status Summary</h2>
                <div class="space-y-3">
                    @if (statusSummary.length === 0) {
                    <p class="text-sm text-slate-400">No status data available.</p>
                    } @else {
                    @for (status of statusSummary; track status.name) {
                    <div class="flex items-center justify-between rounded-lg bg-slate-900/60 px-3 py-2">
                        <span class="text-sm text-slate-200">{{ status.name }}</span>
                        <span class="rounded-full bg-blue-500/20 px-2 py-0.5 text-xs font-semibold text-blue-300">
                            {{ status.count }}
                        </span>
                    </div>
                    }
                    }
                </div>
            </div>

            <div class="rounded-xl border border-slate-700 bg-slate-850/90 p-4 shadow-lg">
                <h2 class="mb-4 text-lg font-semibold text-white">Category Summary</h2>
                <div class="space-y-3">
                    @if (categorySummary.length === 0) {
                    <p class="text-sm text-slate-400">No category data available.</p>
                    } @else {
                    @for (category of categorySummary; track category.name) {
                    <div class="flex items-center justify-between rounded-lg bg-slate-900/60 px-3 py-2">
                        <span class="text-sm text-slate-200">{{ category.name }}</span>
                        <span class="rounded-full bg-violet-500/20 px-2 py-0.5 text-xs font-semibold text-violet-300">
                            {{ category.count }}
                        </span>
                    </div>
                    }
                    }
                </div>
            </div>
        </div>

        <div class="rounded-xl border border-slate-700 bg-slate-850/90 p-4 shadow-lg">
            <h2 class="mb-4 text-lg font-semibold text-white">Recent Enquiries</h2>

            @if (recentEnquiries.length === 0) {
            <p class="text-sm text-slate-400">No enquiries available yet.</p>
            } @else {
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-700 text-left text-sm">
                    <thead class="text-xs uppercase tracking-wide text-slate-400">
                        <tr>
                            <th class="px-3 py-2">Customer</th>
                            <th class="px-3 py-2">Type</th>
                            <th class="px-3 py-2">Date</th>
                            <th class="px-3 py-2">Follow-Up</th>
                            <th class="px-3 py-2">Converted</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-800 text-slate-200">
                        @for (enquiry of recentEnquiries; track enquiry.id) {
                        <tr>
                            <td class="px-3 py-2">
                                <p class="font-medium text-white">{{ enquiry.customerName }}</p>
                                <p class="text-xs text-slate-400">{{ enquiry.customerEmail }}</p>
                            </td>
                            <td class="px-3 py-2">{{ enquiry.enquiryType }}</td>
                            <td class="px-3 py-2">{{ enquiry.enquiryDate | date: 'dd MMM yyyy' }}</td>
                            <td class="px-3 py-2">{{ enquiry.followUpDate | date: 'dd MMM yyyy' }}</td>
                            <td class="px-3 py-2">
                                <span class="rounded-full px-2 py-0.5 text-xs font-semibold"
                                    [class.bg-emerald-500/20]="enquiry.isConverted"
                                    [class.text-emerald-300]="enquiry.isConverted"
                                    [class.bg-amber-500/20]="!enquiry.isConverted"
                                    [class.text-amber-300]="!enquiry.isConverted">
                                    {{ enquiry.isConverted ? 'Yes' : 'No' }}
                                </span>
                            </td>
                        </tr>
                        }
                    </tbody>
                </table>
            </div>
            }
        </div>
    </div>
</section>